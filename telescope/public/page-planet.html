<link rel="import" href="/vendor/polymer/polymer.html">
<link rel="import" href="/layout-graph.html">

<dom-module id="cosmos-planet-list-item">
<style>
.planet-list-item {
  border-bottom: 1px solid #333;
  display: block;
}

.planet-list-item:hover {
  background-color: #489dff;
}

.planet-list-item a {
  padding: 10px 10px;
  color: #bbb;
  display: block;
  text-decoration: none;
}

.planet-list-item a:hover {
  color: #fff;
}
</style>
<template>
  <div class="planet-list-item"><a on-click="onPlanetClicked">{{data.Planet}}</a></div>
</template>
</dom-module>
<script>
Polymer({
  is: 'cosmos-planet-list-item',
  properties: {
    data: {
      type: Object,
      observer: 'planetChanged'
    }
  },
  ready: function() {

  },
  attached: function() {

  },
  planetChanged: function() {
    if (this.data.index != 0) return;
    this.data.eventListener.onPlanetClicked(this.data.Planet);
  },
  onPlanetClicked: function(e) {
    e.preventDefault();
    this.data.eventListener.onPlanetClicked(this.data.Planet);
  }
});
</script>

<dom-module id="cosmos-page-planet">
<style>
.container {
  width: 100%;
  margin: 0 auto;
  padding: 0;
}

@media (min-width: 1080px) {
  .container {
    width: 1080px;
    marign: 0 auto;
  }
}

@media (min-width: 1400px) {
  .container {
    width: 1400px;
    margin: 0 auto;
  }
}

.row {
  margin: 0;
  padding: 0;
}

.left-container {
  width: 100%;
  margin: 0;
  padding: 0;
}

@media (min-width: 1080px) {
  .left-container {
    width: 260px;
    padding: 0 10px;
  }
}

@media (min-width: 1400px) {
  .left-container {
    width: 320px;
    padding: 0 10px;
  }
}

.planet-list {
  margin: 0;
  padding: 20px 0;
}

.main-container {
  width: 100%;
  margin: 0;
  padding: 0;
}

@media (min-width: 1080px) {
  .main-container {
    width: 720px;
  }
}

@media (min-width: 1400px) {
  .main-container {
    width: 1080px;
  }
}

.search {
  padding: 10px 20px;
  background-color: #333;
}

.search input {
  width: 100%;
  background-color: #333;
  outline: none;
  border: none;
  color: #fff;
}

.graph-list {
  padding: 0;
}
</style>
<template>

  <div class="container">

    <div class="row">

      <div class="left-container col-md-4 col-xs-12">
        <div class="search">
          <input id="search-input" type="text" placeholder="search" style="" />
        </div>

        <div class="planet-list">
          <template is="x-repeat" items="{{planets}}">
            <cosmos-planet-list-item data="{{item}}"></cosmos-planet-list-item>
          </template>
        </div>
      </div>

      <div class="main-container col-md-8 col-xs-12">
        <div class="main-container col-md-8 col-xs-12">
          <div class="graph-list">
            <cosmos-layout-graph graph-id="cpu" graph-title="CPU Utilization (%)" graph-unit="%" graph-margin-top="0"></cosmos-layout-graph>
            <cosmos-layout-graph graph-id="memory" graph-title="Memory Usage (MB)" graph-unit="MB"></cosmos-layout-graph>
            <cosmos-layout-graph graph-id="network-in" graph-title="Network In (KB)" graph-unit="KB"></cosmos-layout-graph>
            <cosmos-layout-graph graph-id="network-out" graph-title="Network Out (KB)" graph-unit="KB"></cosmos-layout-graph>
          </div>
        </div>
      </div>

    </div>

  </div>
</template>
</dom-module>
<script>
Polymer({
  is: 'cosmos-page-planet',
  properties: {
    planets: {
      type: Array,
      value: []
    }
  },
  ready: function() {
    var self = this;
    Cosmos.getPlanets(function(json) {
      for (var i = 0; i < json.length; i++) {
          json[i]['index'] = i;
          json[i]['eventListener'] = self;
      }
      self.planets = json;
    }, function(jqXHR) {
      var notification = {
        type: 'error',
        message: "Cosmos server didn't respond any response."
      };
      $('cosmos-layout-header').trigger('cosmos-notification', notification);
    });
  },
  attached: function() {

  },
  detached: function() {

  },
  onPlanetClicked: function(planet) {
    var graphs = $(this).find('cosmos-layout-graph');
    for (var i = 0, length = graphs.length; i < length; i++) {
      graphs[i].setPlanet(planet);
    }
  }
});
</script>
