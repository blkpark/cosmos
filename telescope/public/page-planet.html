<link rel="import" href="/vendor/polymer/polymer.html">
<link rel="import" href="/list-container.html">
<dom-module id="cosmos-page-planet">
<style>
.container {
  width: 100%;
  margin: 0 auto;
  padding: 0;
  background-color: #fff;
}

@media (min-width: 1080px) {
  .container {
    width: 1080px;
    marign: 0 auto;
  }
}

@media (min-width: 1400px) {
  .container {
    width: 1400px;
    margin: 0 auto;
  }
}

header {
  min-height: 60px;
  margin: 0;
  padding: 20px;
  color: #333;
  border-bottom: 1px solid #e7e7ec;
}

header h3 {
  margin: 0;
  padding: 0;
  font-size: 16px;
  font-weight: normal;
  text-align: center;
}

nav {
  margin: 0 10px;
  padding: 10px;
  text-align: center;
  border-bottom: 1px solid #e7e7ec;
}

nav a {
  margin: 0;
  padding: 12px;
  color: #333;
  font-size: 12px;
  text-decoration: none;
  cursor: pointer;
}

@media (min-width: 600px) {
  nav {
    margin: 0 20px;
    padding: 20px;
  }
  nav a {
    padding: 22px;
    font-size: 14px;
  }
}

nav a:hover,
nav a.selected {
  color: #29d;
  text-decoration: none;
  border-bottom: 1px solid #29d;
}

.main-container {
  min-height: 400px;
}
</style>
<template>
  <div class="container">

    <header>
      <h3>{{planet}}</h3>
    </header>

    <nav id="nav">
      <a on-click="onTimelineClicked">Timeline</a>
      <a on-click="onContainersClicked">Containers</a>
      <a on-click="onCpuClicked">CPU</a>
      <a on-click="onMemoryClicked">Memory</a>
      <a on-click="onNetworkClicked">Network</a>
    </nav>

    <div id="main" class="main-container">

      <cosmos-list-container containers="{{containers}}"></cosmos-list-container>

    </div>

  </div>
</template>
</dom-module>
<script>
Polymer({
  is: 'cosmos-page-planet',
  planet: undefined,
  containers: [],
  properties: {

  },
  ready: function() {
    var paths = location.pathname.split('/');
    var planet = paths[2];
    this.planet = planet;

    var links = this.$.nav.querySelectorAll('a');
    links[0].classList.add('selected');
  },
  attached: function() {

  },
  detached: function() {

  },
  deselectNavgationItem: function() {
    var selected = this.$.nav.querySelector('.selected');
    selected.classList.remove('selected');

    this.containers = [];
  },
  selectNavigationItemAtIndex: function(index) {
    this.deselectNavgationItem();
    var links = this.$.nav.querySelectorAll('a');
    links[index].classList.add('selected');
  },
  onTimelineClicked: function() {
    this.selectNavigationItemAtIndex(0);
  },
  onContainersClicked: function() {
    this.selectNavigationItemAtIndex(1);
    NProgress.start();

    var self = this;
    Cosmos.getContainers(this.planet, function(response){
      self.containers = response.data;
      NProgress.done();
    },function(){
      NProgress.done();
    });
  },
  onCpuClicked: function() {
    this.selectNavigationItemAtIndex(2);
  },
  onMemoryClicked: function() {
    this.selectNavigationItemAtIndex(3);
  },
  onNetworkClicked: function() {
    this.selectNavigationItemAtIndex(4);
  }
});
</script>
