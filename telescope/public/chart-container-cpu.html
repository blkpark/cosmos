<link rel="import" href="/vendor/polymer/polymer.html">
<dom-module id="cosmos-chart-container-cpu">
<style>
.cosmos-container {
  width: 100%;
  margin: 0 auto;
  padding: 20px 40px;
  display: block;
}

.title p {
  font-size: 12px;
}

.desc p {
  font-size: 12px;
}
</style>
<template>
  <div id="container" class="cosmos-container">
    <div class="title">
      <h3>CPU Utilization</h3>
      <p>A CPU utilization for a container.</p>
    </div>

    <div id="chart"></div>

    <div class="desc">
      <p>A stopped container won't be updated.</p>
    </div>
  </div>
</template>
</dom-module>
<script>
Polymer({
  is: 'cosmos-chart-container-cpu',
  chart: undefined,
  properties: {

  },
  ready: function() {

  },
  attached: function() {

  },
  detached: function() {

  },
  show: function() {
    if (this.$.chart) this.$.chart.hidden = false;
  },
  hide: function() {
    if (this.$.chart) this.$.chart.hidden = true;
  },
  setChart: function() {
    var chart = c3.generate({
      bindto: this.$.chart,
      data: {
        x: 'date',
        columns: [
          ['date'],
          ['CPU'],
        ]
      },
      point: { show: false },
      tooltip: { show: true },
      axis: {
        x: { tick: { outer: false, format: '%m-%d %H:%M'/*, multiline: true, width: 50*/ }, type: 'timeseries'/*, height: 40*/ }, // set height of axis.x to avoid overlap with legend
        y: { tick: { outer: false }, min: 0 }
      },
      grid: {
        x: { show: true },
        y: { show: true }
      },
      legend: { position: 'bottom' } // this is a legend part. default position is 'bottom'
    });

    this.chart = chart;
  },
  load: function(metrics) {
    if (!metrics) return;

    var times = ['date'];
    var values = ['CPU'];

    var time = undefined;
    var value = undefined;
    for (var i = 0, len = metrics.length; i < len; i++) {
      time = new Date(metrics[i][0]);
      value = metrics[i][1];

      times.push(time);
      values.push(value);
    }

    if (!this.chart) this.setChart();
    this.chart.load({
      columns: [
        times,
        values
      ]
    });

  }
});
</script>
