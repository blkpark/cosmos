<link rel="import" href="/vendor/polymer/polymer.html">
<link rel="import" href="/newsfeed-item.html">
<dom-module id="cosmos-page-cosmos">
<style>
.container {
  width: 100%;
  margin: 0;
  padding: 0;
}

@media (min-width: 1080px) {
  .container {
    width: 1080px;
    margin: 0 auto;
  }
}

.col-md-12,
.col-xs-12 {
  margin: 0;
  padding: 0;
}
</style>
<template>
  <div class="container">
    <template is="x-repeat" items="{{newsfeeds}}">
      <div class="col-md-12 col-xs-12">
        <cosmos-newsfeed-item newsfeed={{item}}></cosmos-newsfeed-item>
      </div>
    </template>
  </div>
</template>
</dom-module>
<script>
Polymer({
  is: 'cosmos-page-cosmos',
  properties: {
    newsfeeds: {
      type: Array,
      value: []
    }
  },
  ready: function() {
    this.getNewsfeeds();
  },
  getNewsfeeds: function() {
    var self = this;
    Cosmos.getNewsFeeds(function(response) {
      for (var i = 0; i < response.length; i++) {
        response[i].TimeLabel = moment(response[i].Time * 1000).format('YYYY-MM-DD HH:mm');
        response[i].AgoLabel = moment(response[i].Time * 1000).fromNow();
      }
      self.newsfeeds = response;

      if (self.newsfeeds.length == 0) {
        var notification = {
          type: 'information',
          message: "There is not news feed yet."
        };
        $('cosmos-layout-header').trigger('cosmos-notification', notification);
      }
    }, function(jqXHR) {
      var notification = {
        type: 'error',
        message: 'Cosmos server did not respond any response.'
      };
      $('cosmos-layout-header').trigger('cosmos-notification', notification);
    });
  }
});
</script>
